<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Solidity极简入门: 13. 继承 | WTFSolidity-web</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="WTFSolidity 中文站点">
    
    <link rel="preload" href="/assets/css/0.styles.87888c96.css" as="style"><link rel="preload" href="/assets/js/app.cda10564.js" as="script"><link rel="preload" href="/assets/js/2.342d682f.js" as="script"><link rel="preload" href="/assets/js/3.3f2ce87b.js" as="script"><link rel="prefetch" href="/assets/js/10.33814d21.js"><link rel="prefetch" href="/assets/js/11.51cd0748.js"><link rel="prefetch" href="/assets/js/12.497ca39b.js"><link rel="prefetch" href="/assets/js/13.2117d4e8.js"><link rel="prefetch" href="/assets/js/14.27bd9a33.js"><link rel="prefetch" href="/assets/js/15.d45d726d.js"><link rel="prefetch" href="/assets/js/16.31fba7c2.js"><link rel="prefetch" href="/assets/js/17.3490478d.js"><link rel="prefetch" href="/assets/js/18.8b0f4966.js"><link rel="prefetch" href="/assets/js/19.4ff0b904.js"><link rel="prefetch" href="/assets/js/20.923a791d.js"><link rel="prefetch" href="/assets/js/21.fc8be3f0.js"><link rel="prefetch" href="/assets/js/22.2eb0c867.js"><link rel="prefetch" href="/assets/js/23.05ed0694.js"><link rel="prefetch" href="/assets/js/24.54bda0d3.js"><link rel="prefetch" href="/assets/js/25.b5e74585.js"><link rel="prefetch" href="/assets/js/26.aea75b7b.js"><link rel="prefetch" href="/assets/js/27.50b3493b.js"><link rel="prefetch" href="/assets/js/28.91d81d2e.js"><link rel="prefetch" href="/assets/js/29.ea23fbbd.js"><link rel="prefetch" href="/assets/js/30.a1d02709.js"><link rel="prefetch" href="/assets/js/31.d7fd3f0d.js"><link rel="prefetch" href="/assets/js/32.f3fd7465.js"><link rel="prefetch" href="/assets/js/33.e6cabf2d.js"><link rel="prefetch" href="/assets/js/34.7d902d89.js"><link rel="prefetch" href="/assets/js/35.2f976b32.js"><link rel="prefetch" href="/assets/js/36.9c877d85.js"><link rel="prefetch" href="/assets/js/37.9f665b50.js"><link rel="prefetch" href="/assets/js/38.28c256e7.js"><link rel="prefetch" href="/assets/js/39.31704719.js"><link rel="prefetch" href="/assets/js/4.4890c017.js"><link rel="prefetch" href="/assets/js/40.b4b66a54.js"><link rel="prefetch" href="/assets/js/41.0472b5ca.js"><link rel="prefetch" href="/assets/js/42.ca4d307f.js"><link rel="prefetch" href="/assets/js/43.2a1c58ec.js"><link rel="prefetch" href="/assets/js/44.657037ab.js"><link rel="prefetch" href="/assets/js/45.8cee957f.js"><link rel="prefetch" href="/assets/js/46.daa5d15a.js"><link rel="prefetch" href="/assets/js/47.dbccfdf1.js"><link rel="prefetch" href="/assets/js/48.b376f780.js"><link rel="prefetch" href="/assets/js/49.7bc098c8.js"><link rel="prefetch" href="/assets/js/5.684b967b.js"><link rel="prefetch" href="/assets/js/6.a2d48af7.js"><link rel="prefetch" href="/assets/js/7.4ff2d5e1.js"><link rel="prefetch" href="/assets/js/8.bf31f299.js"><link rel="prefetch" href="/assets/js/9.71bf02a9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.87888c96.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">WTFSolidity-web</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/AmazingAng/WTFSolidity" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WTFSolidity
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/EasyChris/WTFSolidity-web" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/AmazingAng/WTFSolidity" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WTFSolidity
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/EasyChris/WTFSolidity-web" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Hello Web 3</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Value Types</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Function</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Return</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Data Storage</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Array And Struct</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mapping</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Initial Value</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Constant</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Insertion Sort</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Modifier</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Event</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Inheritance</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/inheritance/" aria-current="page" class="active sidebar-link">Solidity极简入门: 13. 继承</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/inheritance/#继承" class="sidebar-link">继承</a></li><li class="sidebar-sub-header"><a href="/inheritance/#在remix上验证" class="sidebar-link">在Remix上验证</a></li><li class="sidebar-sub-header"><a href="/inheritance/#总结" class="sidebar-link">总结</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Interface</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Errors</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Overloading</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Library</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Import</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Fallback</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Send ETH</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Call Contract</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Call</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Delegatecall</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Create</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Create 2</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Delete Contract</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ABI Encode</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Hash</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Selector</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Try Catch</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ERC 20</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Faucet</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Faucet Sol</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Airdrop</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ERC 721</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Img</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>专题</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="solidity极简入门-13-继承"><a href="#solidity极简入门-13-继承" class="header-anchor">#</a> Solidity极简入门: 13. 继承</h1> <p>我最近在重新学solidity，巩固一下细节，也写一个“Solidity极简入门”，供小白们使用（编程大佬可以另找教程），每周更新1-3讲。</p> <p>欢迎关注我的推特：<a href="https://twitter.com/0xAA_Science" target="_blank" rel="noopener noreferrer">@0xAA_Science<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>WTF技术社群discord，内有加微信群方法：<a href="https://discord.gg/5akcruXrsk" target="_blank" rel="noopener noreferrer">链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>所有代码和教程开源在github（1024个star发课程认证，2048个star发社群NFT）: <a href="https://github.com/AmazingAng/WTFSolidity" target="_blank" rel="noopener noreferrer">github.com/AmazingAng/WTFSolidity<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <hr> <p>这一讲，我们介绍<code>solidity</code>中的继承（<code>inheritance</code>），包括简单继承，多重继承，以及修饰器（<code>modifier</code>）和构造函数（<code>constructor</code>）的继承。</p> <h2 id="继承"><a href="#继承" class="header-anchor">#</a> 继承</h2> <p>继承是面向对象编程很重要的组成部分，可以显著减少重复代码。如果把合约看作是对象的话，<code>solidity</code>也是面向对象的编程，也支持继承。</p> <h3 id="规则"><a href="#规则" class="header-anchor">#</a> 规则</h3> <ul><li><p><code>virtual</code>: 父合约中的函数，如果希望子合约重写，需要加上<code>virtual</code>关键字。</p></li> <li><p><code>override</code>：子合约重写了父合约中的函数，需要加上<code>override</code>关键字。</p></li></ul> <h3 id="简单继承"><a href="#简单继承" class="header-anchor">#</a> 简单继承</h3> <p>我们先写一个简单的爷爷合约<code>Yeye</code>，里面包含1个<code>Log</code>事件和3个<code>function</code>: <code>hip()</code>, <code>pop()</code>, <code>yeye()</code>，输出都是”Yeye”。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token keyword">contract</span> <span class="token class-name">Yeye</span> <span class="token punctuation">{</span>
    <span class="token keyword">event</span> <span class="token function">Log</span><span class="token punctuation">(</span><span class="token builtin">string</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 定义3个function: hip(), pop(), man()，Log值为Yeye。</span>
    <span class="token keyword">function</span> <span class="token function">hip</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> virtual<span class="token punctuation">{</span>
        <span class="token keyword">emit</span> <span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Yeye&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> virtual<span class="token punctuation">{</span>
        <span class="token keyword">emit</span> <span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Yeye&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">yeye</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> virtual <span class="token punctuation">{</span>
        <span class="token keyword">emit</span> <span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Yeye&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们再定义一个爸爸合约<code>Baba</code>，让他继承<code>Yeye</code>合约，语法就是<code>contract Baba is Yeye</code>，非常直观。在<code>Baba</code>合约里，我们重写一下<code>hip()</code>和<code>pop()</code>这两个函数，加上<code>override</code>关键字，并将他们的输出改为<code>”Baba”</code>；并且加一个新的函数<code>baba</code>，输出也是<code>”Baba”</code>。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token keyword">contract</span> <span class="token class-name">Baba</span> <span class="token keyword">is</span> Yeye<span class="token punctuation">{</span>
    <span class="token comment">// 继承两个function: hip()和pop()，输出改为Baba。</span>
    <span class="token keyword">function</span> <span class="token function">hip</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> virtual override<span class="token punctuation">{</span>
        <span class="token keyword">emit</span> <span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Baba&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> virtual override<span class="token punctuation">{</span>
        <span class="token keyword">emit</span> <span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Baba&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">baba</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> virtual<span class="token punctuation">{</span>
        <span class="token keyword">emit</span> <span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Baba&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们部署合约，可以看到<code>Baba</code>合约里有4个函数，其中<code>hip()</code>和<code>pop()</code>的输出被成功改写成<code>”Baba”</code>，而继承来的<code>yeye()</code>的输出仍然是<code>”Yeye”</code>。</p> <h3 id="多重继承"><a href="#多重继承" class="header-anchor">#</a> 多重继承</h3> <p><code>solidity</code>的合约可以继承多个合约。规则：</p> <p>继承时要按辈分最高到最低的顺序排。比如我们写一个<code>Erzi</code>合约，继承<code>Yeye</code>合约和<code>Baba</code>合约，那么就要写成<code>contract Erzi is Yeye, Baba</code>，而不能写成<code>contract Erzi is Baba, Yeye</code>，不然就会报错。
如果某一个函数在多个继承的合约里都存在，比如例子中的<code>hip()</code>和<code>pop()</code>，在子合约里必须重写，不然会报错。
重写在多个父合约中重名函数时，<code>override</code>关键字后面要加上所有父合约名字，例如<code>override(Yeye, Baba)</code>。
例子：</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token keyword">contract</span> <span class="token class-name">Erzi</span> <span class="token keyword">is</span> Yeye<span class="token punctuation">,</span> Baba<span class="token punctuation">{</span>
    <span class="token comment">// 继承两个function: hip()和pop()，输出值为Erzi。</span>
    <span class="token keyword">function</span> <span class="token function">hip</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> virtual <span class="token function">override</span><span class="token punctuation">(</span>Yeye<span class="token punctuation">,</span> Baba<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">emit</span> <span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Erzi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> virtual <span class="token function">override</span><span class="token punctuation">(</span>Yeye<span class="token punctuation">,</span> Baba<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">emit</span> <span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Erzi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>我们可以看到，<code>Erzi</code>合约里面重写了<code>hip()</code>和<code>pop()</code>两个函数，将输出改为<code>”Erzi”</code>，并且还分别从<code>Yeye</code>和<code>Baba</code>合约继承了<code>yeye()</code>和<code>baba()</code>两个函数。</p> <h3 id="修饰器的继承"><a href="#修饰器的继承" class="header-anchor">#</a> 修饰器的继承</h3> <p><code>Solidity</code>中的修饰器（<code>Modifier</code>）同样可以继承，用法与函数继承类似，在相应的地方加<code>virtual</code>和<code>override</code>关键字即可。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token keyword">contract</span> <span class="token class-name">Base1</span> <span class="token punctuation">{</span>
    <span class="token keyword">modifier</span> <span class="token function">exactDividedBy2And3</span><span class="token punctuation">(</span><span class="token builtin">uint</span> _a<span class="token punctuation">)</span> virtual <span class="token punctuation">{</span>
        <span class="token keyword">require</span><span class="token punctuation">(</span>_a <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> _a <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">_</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">contract</span> <span class="token class-name">Identifier</span> <span class="token keyword">is</span> Base1 <span class="token punctuation">{</span>

    <span class="token comment">//计算一个数分别被2除和被3除的值，但是传入的参数必须是2和3的倍数</span>
    <span class="token keyword">function</span> <span class="token function">getExactDividedBy2And3</span><span class="token punctuation">(</span><span class="token builtin">uint</span> _dividend<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">exactDividedBy2And3</span><span class="token punctuation">(</span>_dividend<span class="token punctuation">)</span> <span class="token keyword">pure</span> <span class="token keyword">returns</span><span class="token punctuation">(</span><span class="token builtin">uint</span><span class="token punctuation">,</span> <span class="token builtin">uint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getExactDividedBy2And3WithoutModifier</span><span class="token punctuation">(</span>_dividend<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//计算一个数分别被2除和被3除的值</span>
    <span class="token keyword">function</span> <span class="token function">getExactDividedBy2And3WithoutModifier</span><span class="token punctuation">(</span><span class="token builtin">uint</span> _dividend<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">pure</span> <span class="token keyword">returns</span><span class="token punctuation">(</span><span class="token builtin">uint</span><span class="token punctuation">,</span> <span class="token builtin">uint</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token builtin">uint</span> div2 <span class="token operator">=</span> _dividend <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token builtin">uint</span> div3 <span class="token operator">=</span> _dividend <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>div2<span class="token punctuation">,</span> div3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面的Identifier可以直接在代码中使用exactDividedBy2And3这个修饰器，也可以像下面一样重写修饰器。</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code>    <span class="token keyword">modifier</span> <span class="token function">exactDividedBy2And3</span><span class="token punctuation">(</span><span class="token builtin">uint</span> _a<span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token keyword">_</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="构造函数的继承"><a href="#构造函数的继承" class="header-anchor">#</a> 构造函数的继承</h3> <p>子合约有两种方法继承父合约的构造函数。举个简单的例子，父合约<code>A</code>里面有一个状态变量<code>a</code>，并由构造函数的参数来确定：</p> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token comment">// 构造函数的继承</span>
abstract <span class="token keyword">contract</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token builtin">uint</span> <span class="token keyword">public</span> a<span class="token punctuation">;</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token builtin">uint</span> _a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        a <span class="token operator">=</span> _a<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol><li>在继承时声明父构造函数的参数，例如：<code>contract B is A(1)</code></li> <li>在子合约的构造函数中声明构造函数的参数，例如：</li></ol> <div class="language-solidity extra-class"><pre class="language-solidity"><code><span class="token keyword">contract</span> <span class="token class-name">C</span> <span class="token keyword">is</span> A <span class="token punctuation">{</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token builtin">uint</span> _c<span class="token punctuation">)</span> <span class="token function">A</span><span class="token punctuation">(</span>_c <span class="token operator">*</span> _c<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="调用父合约的函数"><a href="#调用父合约的函数" class="header-anchor">#</a> 调用父合约的函数</h3> <p>子合约有两种方式调用父合约的函数，直接调用和利用<code>super</code>关键字。</p> <ol><li>直接调用：子合约可以直接用<code>父合约名.函数名()</code>的方式来调用父合约函数，例如<code>Yeye.pop()</code>。</li></ol> <div class="language-solidity extra-class"><pre class="language-solidity"><code>    <span class="token keyword">function</span> <span class="token function">callParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>
        Yeye<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li><code>super</code>关键字：子合约可以利用<code>super.函数名()</code>来调用最近的父合约函数。<code>solidity</code>继承关系按声明时从右到左的顺序是：<code>contract Erzi is Yeye, Baba</code>，那么<code>Baba</code>是最近的父合约，<code>super.pop()</code>将调用<code>Baba.pop()</code>而不是<code>Yeye.pop()</code>：</li></ol> <div class="language-solidity extra-class"><pre class="language-solidity"><code>    <span class="token keyword">function</span> <span class="token function">callParentSuper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>
        <span class="token comment">// 将调用最近的父合约函数，Baba.pop()</span>
        super<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h2 id="在remix上验证"><a href="#在remix上验证" class="header-anchor">#</a> 在Remix上验证</h2> <ul><li>合约简单继承示例, 可以观察到Baba合约多了Yeye的函数
<img src="/assets/img/13-1.42d8e8a6.png" alt="13-1"> <img src="/assets/img/13-2.ca20ff0f.png" alt="13-2"></li> <li>合约多重继承可以参考简单继承的操作步骤来增加部署Erzi合约，然后观察暴露的函数以及尝试调用来查看日志</li> <li>修饰器继承示例
<img src="/assets/img/13-3.9fba2e32.png" alt="13-3"> <img src="/assets/img/13-4.2e812f46.png" alt="13-4"> <img src="/assets/img/13-5.32bd7ada.png" alt="13-5"></li> <li>构造函数继承示例
<img src="/assets/img/13-6.d25654e1.png" alt="13-6"> <img src="/assets/img/13-7.39a52efa.png" alt="13-7"></li> <li>调用父合约示例
<img src="/assets/img/13-8.3bf69b27.png" alt="13-8"> <img src="/assets/img/13-9.d05667e1.png" alt="13-9"></li></ul> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>这一讲，我们介绍了<code>solidity</code>继承的基本用法，包括简单继承，多重继承，修饰器和构造函数的继承，以及调用父合约中的函数。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/29/2022, 10:06:07 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/event/" class="prev">
        Solidity极简入门: 12. 事件
      </a></span> <span class="next"><a href="/interface/">
        Solidity极简入门: 14. 抽象合约和接口
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.cda10564.js" defer></script><script src="/assets/js/2.342d682f.js" defer></script><script src="/assets/js/3.3f2ce87b.js" defer></script>
  </body>
</html>
